DELIMITER #

CREATE PROCEDURE IF NOT EXISTS ADD_NAME(IN ROLL INT, IN NM VARCHAR(20))
BEGIN
    INSERT INTO RESULT(S_ROLL, S_NAME)
    VALUES(ROLL, NM);
    INSERT INTO STUD_MARKS(S_ROLL)
    VALUES(ROLL);
END#

CREATE PROCEDURE IF NOT EXISTS ADD_RESULT(IN ROLL INT)
BEGIN
    DECLARE GRADE VARCHAR(20);
    DECLARE MARKS INT;

    SELECT S_MARKS INTO MARKS
    FROM STUD_MARKS 
    WHERE S_ROLL = ROLL;

    SET GRADE = (CASE 
    WHEN MARKS IS NULL THEN
        "MISSING"
    WHEN MARKS > 1500 THEN
        "IMPOSSIBLE"
    WHEN MARKS >= 990 THEN
        "DISTINCTION"
    WHEN MARKS >= 900 THEN
        "1ST CLASS"
    WHEN MARKS >= 825 THEN
        "HIGHER 2ND CLASS"
    WHEN MARKS < 400 THEN
        "FAIL"
    ELSE
        "PASS"
    END);

    UPDATE RESULT
    SET S_GRADE = GRADE
    WHERE S_ROLL = ROLL;
END#

CREATE PROCEDURE IF NOT EXISTS ADD_MARKS(IN ROLL INT, IN MARKS INT)
BEGIN
    UPDATE STUD_MARKS
    SET S_MARKS = MARKS
    WHERE S_ROLL = ROLL;
    CALL ADD_RESULT(ROLL);
END#

DELIMITER ;

CREATE TABLE STUD_MARKS (S_ROLL INT UNIQUE, S_MARKS INT);

CREATE TABLE RESULT (S_ROLL INT UNIQUE, S_NAME VARCHAR(20), S_GRADE VARCHAR(20));

CALL ADD_NAME(1,"SOHAM");   CALL ADD_MARKS(1,1501);
CALL ADD_NAME(2,"ABC");     CALL ADD_MARKS(2,990);
CALL ADD_NAME(3,"PQR");     CALL ADD_MARKS(3,900);
CALL ADD_NAME(4,"XYZ");     CALL ADD_MARKS(4,825);
CALL ADD_NAME(5,"AAA");     CALL ADD_MARKS(5,400);
CALL ADD_NAME(6,"BBB");     CALL ADD_MARKS(6,399);
CALL ADD_NAME(7,"CCC");     CALL ADD_RESULT(7);

SELECT * FROM RESULT;

DROP TABLE STUD_MARKS;

DROP TABLE RESULT;

DROP PROCEDURE ADD_MARKS;

DROP PROCEDURE ADD_NAME;

DROP PROCEDURE ADD_RESULT;
